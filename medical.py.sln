import tkinter as tk
from tkinter import ttk, messagebox

PATIENTS = [
    ("John Doe", "45", "150/95"),
    ("Jane Smith", "50", "135/88"),
    ("Mark Lee", "60", "142/91"),
    ("Alice Ray", "38", "128/82"),
    ("Tom Ford", "55", "160/100")
]

def is_high_bp(bp):
    try:
        systolic, diastolic = map(int, bp.split("/"))
        return systolic >= 140 or diastolic >= 90
    except:
        return False

def refresh_table():
    for row in tree.get_children():
        tree.delete(row)
    for patient in PATIENTS:
        if is_high_bp(patient[2]):
            tree.insert("", "end", values=patient)

def add_patient():
    name = name_var.get().strip()
    age = age_var.get().strip()
    bp = bp_var.get().strip()

    if not name or not age or not bp:
        messagebox.showerror("Error", "Please fill all fields.")
        return

    try:
        int(age)
        systolic, diastolic = map(int, bp.split("/"))
    except:
        messagebox.showerror("Error", "Invalid age or BP format (use 120/80).")
        return

    PATIENTS.append((name, age, bp))
    refresh_table()
    name_var.set("")
    age_var.set("")
    bp_var.set("")

def delete_patient():
    selected = tree.selection()
    if not selected:
        messagebox.showwarning("Warning", "Select a patient to delete.")
        return

    for sel in selected:
        values = tree.item(sel, "values")
        if values in PATIENTS:
            PATIENTS.remove(values)
        tree.delete(sel)
root = tk.Tk()
root.title("Medical BP Tracker")
root.geometry("600x500")
columns = ("Name", "Age", "BP")
tree = ttk.Treeview(root, columns=columns, show="headings")
for col in columns:
    tree.heading(col, text=col)
    tree.column(col, width=150 if col == "Name" else 70, anchor="center")

scrollbar = ttk.Scrollbar(root, orient="vertical", command=tree.yview)
tree.configure(yscroll=scrollbar.set)
tree.pack(side="left", fill="both", expand=True)
scrollbar.pack(side="right", fill="y")
form_frame = tk.Frame(root, padx=10, pady=10)
form_frame.pack(fill="x")

tk.Label(form_frame, text="Name:").grid(row=0, column=0, sticky="w")
tk.Label(form_frame, text="Age:").grid(row=1, column=0, sticky="w")
tk.Label(form_frame, text="BP (e.g. 140/90):").grid(row=2, column=0, sticky="w")

name_var = tk.StringVar()
age_var = tk.StringVar()
bp_var = tk.StringVar()

tk.Entry(form_frame, textvariable=name_var).grid(row=0, column=1, pady=2)
tk.Entry(form_frame, textvariable=age_var).grid(row=1, column=1, pady=2)
tk.Entry(form_frame, textvariable=bp_var).grid(row=2, column=1, pady=2)

tk.Button(form_frame, text="Add Patient", command=add_patient).grid(row=3, column=0, pady=5)
tk.Button(form_frame, text="Delete Selected", command=delete_patient).grid(row=3, column=1, pady=5)
refresh_table()

root.mainloop()
